---
title: "SharePoint 2013 で JavaScript からユーザー選択ウィンドウ (PeoplePicker) を呼び出す"
emoji: "💻"
type: "tech"
topics: ["javascript", "sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2017/1/20 に投稿したものの転載です。
:::

`<SharePoint:PeopleEditor>` を使わずに JavaScript だけでダイアログを表示してユーザー選択をさせるサンプルです。

https://github.com/karamem0/samples/tree/main/sharepoint-javascript-people-picker

やっていることは割と簡単で `/_layouts/15/Picker.aspx` を `SP.UI.ModalDialog.showModalDialog` で呼び出すだけです。戻り値として XML が返ってくるので中身を読んであげれば選択されたユーザーの情報が取れます。

初期表示はこんな感じ。

![](/images/2017_01_20_190000_001.png)

ユーザー選択のダイアログが表示されます。

![](/images/2017_01_20_190000_002.png)

ログイン ID だけでなく表示名なども取れます。

![](/images/2017_01_20_190000_003.png)
