---
title: "SharePoint 2019 で SharePoint 2013 ワークフローを使用できるようにする"
emoji: "💻"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2019/8/6 に投稿したものの転載です。
:::

# はじめに

SharePoint Online であれば Flow を使えば問題ないのですが、オンプレミスの SharePoint 2019 の場合は、まだまだ SharePoint ワークフローを利用する機会は多いと思います。そして、標準で使える SharePoint 2010 ワークフローよりも、HTTP Web アクセスでの REST API 呼び出しによる柔軟なワークフロー開発を行うために、SharePoint 2013 ワークフローを使いたいということも多いと思います。SharePoint 2019 でも SharePoint 2013 ワークフローはサポートされていますが、主に Workflow Manager のインストール手順がちょっと変わっていますので、確認してみたいと思います。

# 構築方法

## Web Platform Installer のインストール

まだ生きてたんかい！と思わず突っ込みを入れたくなってしまいますが、Workflow Manager をインストールするためにはまず Web Platform Installer をインストールする必要があります。

https://www.microsoft.com/web/downloads/platform.aspx

![](/images/2019_08_06_120000_001.png)

## Workflow Manager 1.0 のインストール

Web Platform Installer を起動して **Workflow** で検索をかけると Workflow Manager 1.0 が結果に出てきます。まずはこれをインストールします。インストール後、構成を聞かれますが、これはいったんキャンセルしておきます。そして Web Platform Installer も終了させておきます。大変面倒なのですが、Web Platform Installer はインストールの依存関係の情報を起動時にしか読み込んでくれないようなので、この手順は必須になります。

![](/images/2019_08_06_120000_002.png)

## Service Bus 1.0 CU1 のインストール

Workflow Manager 1.0 をインストールすると、同時に Service Bus 1.0 もインストールされますが、こちらの CU が出ているのでインストールします。Web Platform Installer を起動して **Service Bus** で検索をかけると Service Bus 1.0 CU1 が結果に出てきますのでこれをインストールします。インストールが終わったら Web Platform Installer を終了します。

![](/images/2019_08_06_120000_003.png)

## Workflow Manager 1.0 CU5 のインストール

そして今度は Workflow Manager 1.0 CU5 をインストールします。ちゃんと Web Platform Installer を開きなおしていればエラーは出ないはずですが、依存関係でエラーが出る場合は、Web Platform Installer を終了させてから起動しなおしたかどうかを確認してください。

![](/images/2019_08_06_120000_004.png)

## Workflow Manager の構成

ここまでインストールできたらようやく Workflow Manager の構成を行います。なお Workflow Manager の構成でエラーが出る場合、正しく CU が当たっていない可能性があります。

あとは `Register-SPWorkflowService` コマンドレットを実行して SharePoint Server にワークフローを登録します。ここの手順は SharePoint 2013 と変更ありません。

https://shanqiai.weblogs.jp/sharepoint_technical_note/2013/02/sp2013-workflow-manager-1-installation.html

# おわりに

CU をインストールする手順が意外に厄介です。インストールの順番と、ちゃんと Web Platform Installer をインストールするごとに終了して起動しなおす、を忘れなければ、トラブルなく構築できるのではないかと思います。
