---
title: "platyPS ã§ PowerShell ãƒ˜ãƒ«ãƒ— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç°¡å˜ã«æ›¸ã"
emoji: "ğŸ’»"
type: "tech"
topics: ["csharp", "powershell"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2019/2/8 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

# ã¯ã˜ã‚ã«

PowerShell ãƒãƒ¼ãƒ ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ platyPS ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚

https://github.com/PowerShell/platyPS

ã–ã£ãã‚Šã„ã†ã¨ã€æ—¢å­˜ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ Markdown å½¢å¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã€ã•ã‚‰ã« Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ PowerShell ãƒ˜ãƒ«ãƒ— ãƒ•ã‚¡ã‚¤ãƒ« (`dll-Help.xml`) ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ Markdown å½¢å¼ã§ç®¡ç†ã§ãã‚‹ã®ã§ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¨˜è¿°ãŒå®¹æ˜“ã§ã™ã—ã€GitHub ã«å…¬é–‹ã—ã¦ãŠã‘ã°ãã®ã¾ã¾ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã‚‚ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

# Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹

ã“ã‚“ãªã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½œã£ãŸã¨ã—ã¦ã€‚

```csharp
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Management.Automation;
using System.Text;

namespace SampleModule
{
    [Cmdlet("Write", "HelloWorld")]
    public class WriteHelloWorldCommand : PSCmdlet
    {
        protected override void ProcessRecord()
        {
            this.WriteObject(JsonConvert.SerializeObject(new { Message = "Hello World" }));
        }
    }
}
```

å¯¾è±¡ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã‹ã‚‰ `New-MarkdownHelp` ã‚’å‘¼ã³å‡ºã™ã¨ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã”ã¨ã« Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãã‚Œã¾ã™ã€‚

```powershell
Import-Module -Name ".\bin\Debug\SampleModule.psd1"
New-MarkdownHelp -Module "SampleModule" -OutputFolder ".\documents\"
```

ç”Ÿæˆã•ã‚ŒãŸ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰èª­ã¿å–ã£ãŸæƒ…å ±ãŒè‡ªå‹•çš„ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‚‚ã®ã®ã€èª¬æ˜ãªã©ã¯å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚`{{}}` ã§å›²ã¾ã‚Œã¦ã„ã‚‹ç®‡æ‰€ã«ã¤ã„ã¦ä¿®æ­£ã—ã¦ã„ãã¾ã™ã€‚

````
---
external help file: SampleModule.dll-Help.xml
Module Name: SampleModule
online version:
schema: 2.0.0
---

# Write-HelloWorld

## SYNOPSIS
{{Fill in the Synopsis}}

## SYNTAX

```
Write-HelloWorld [<CommonParameters>]
```

## DESCRIPTION
{{Fill in the Description}}

## EXAMPLES

### Example 1
```powershell
PS C:\> {{ Add example code here }}
```

{{ Add example description here }}

## PARAMETERS

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable.
For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None

## OUTPUTS

### System.Object
## NOTES

## RELATED LINKS
````

# ãƒ˜ãƒ«ãƒ— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹

ä¿®æ­£ãŒçµ‚ã‚ã£ãŸã‚‰ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æŒ‡å®šã—ã¦ `New-ExternalHelp` ã‚’å‘¼ã³å‡ºã—ã¦ãƒ˜ãƒ«ãƒ— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

```powershell
New-ExternalHelp -Path ".\documents\" -OutputPath ".\bin\Debug\SampleModule.dll-Help.xml"
```

ã“ã‚Œã ã‘ã§ã™ã€‚ç°¡å˜ã§ã™ã­ã€‚

# ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å¤‰æ›´ã‚’ Markdown ã«åæ˜ ã™ã‚‹

é–‹ç™ºã‚’é€²ã‚ã¦ã„ãã†ã¡ã«ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«æ–°ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå¢—ãˆãŸã‚Šã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ãã®ã‚ˆã†ãªå ´åˆã¯ Update-MarkdownHelp ã‚’å‘¼ã³å‡ºã™ã¨ã„ã„æ„Ÿã˜ã«å·®åˆ†ã‚’æ›´æ–°ã—ã¦ãã‚Œã¾ã™ã€‚[^1]

```powershell
Import-Module -Name ".\bin\Debug\SampleModule.psd1"
Update-MarkdownHelp -Path ".\documents\"
```

ä¿®æ­£ã—ãŸã‚‰ã¾ãŸ `New-ExternalHelp` ã§ãƒ˜ãƒ«ãƒ— ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç”Ÿæˆã—ã¾ã™ã€‚ãªãŠæ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã¨ä¸Šæ›¸ãã•ã‚Œãªã„ã®ã§ `Force` ã‚’ä»˜ã‘ã‚‹ã®ã‚’å¿˜ã‚Œãšã«ã€‚

[^1]: `New-MarkdownHelp` ã¨ `Update-MarkdownHelp` ã§å¾®å¦™ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒé•ã†ã®ã§æ³¨æ„ã€‚ã©ã†ã—ã¦ã“ã†ãªã£ãŸã€‚
