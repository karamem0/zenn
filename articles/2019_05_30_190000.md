---
title: "Microsoft Graph data connect が一般提供されました"
emoji: "💻"
type: "tech"
topics: ["powershell", "sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2019/5/30 に投稿したものの転載です。
:::

Build 2019 で Microsoft Graph data connect が一般提供されました。

https://developer.microsoft.com/en-us/office/blogs/build-2019-microsoft-graph-powers-the-microsoft-365-platform?WT.mc_id=M365-MVP-5002941

日本は？[^1]

ところで改めて試したところこんなエラーが出てしまいました。

![](/images/2019_05_30_190000_001.png)

```json
{
    "errorCode": "2200",
    "message": "ErrorCode=UserErrorOffice365DataLoaderError,'Type=Microsoft.DataTransfer.Common.Shared.HybridDeliveryException,Message=Office365 data loading failed to execute. None of the users requested were valid. Ensure the users are enabled and have both a valid Exchange and Workplace Analytics license,Source=Microsoft.DataTransfer.ClientLibrary,'",
    "failureType": "UserError",
    "target": "Copy Data"
}
```

Workplace Analytics ってなんやねん。

Microsoft Graph のドキュメントには

> Access to the Microsoft Graph data connect toolset is available through Workplace Analytics

https://docs.microsoft.com/ja-jp/graph/data-connect-policies?WT.mc_id=M365-MVP-5002941

と書いており、Microsoft Graph data connect へのアクセスには Workplace Analytics が必要なようです。ところがいくら探しても Workplace Analytics は出てきません。

さらに探していたところ、以下の記事にたどり着きました。

https://shanqiai.weblogs.jp/sharepoint_technical_note/2017/08/microsoft-workplace-analytics-largeenterprise.html

つまり現時点では大企業でないと Microsoft Graph data connect は使用できないということです。確かに機能としては大企業向けというのはわかるのですが、試すこともできないというのは結構つらい気がします。まあそもそも日本で使えませんけど。

[^1]: まだみたいですね。
