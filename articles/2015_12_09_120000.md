---
title: "SharePoint Online で Microsoft アカウントに共有するときのトラブルについて"
emoji: "💻"
type: "tech"
topics: ["azuread", "sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2015/12/9 に投稿したものの転載です。
:::

:::message alert
2019/4/10 追記: 現時点で、Azure AD で Microsoft アカウントをユーザーとして (ゲスト ユーザーとしてではなく) 追加することはできません。また、既存の Microsoft アカウントをソースとするアカウントでも正しく共有できるようです。
:::

# はじめに

この記事は **Office 365 Advent Calendar 2015** の参加記事です。

https://www.adventar.org/calendars/790

SharePoint Online では組織外のユーザーを招待することで Microsoft アカウントで SharePoint を使用することができます。通常は Office 365 のライセンスが割り当てられていないと SharePoint を使用することができませんが、この方法だと、ライセンスのないユーザーでも使用することができてしまいます。

https://support.office.com/ja-jp/article/1fe37332-0f9a-4719-970e-d2578da4941c?WT.mc_id=M365-MVP-5002941

組織外のユーザーの場合、いくつかの機能制限はあるものの、基本的なほとんどのことができてしまいます。うまく利用するとコスト削減にもつながりますので、是非活用したいものです。

https://docs.microsoft.com/ja-jp/sharepoint/external-sharing-overview?WT.mc_id=M365-MVP-5002941

さてここからが本題。

SharePoint Online に組織外のユーザーを追加するときに、手順を間違えるとうまくいかないことがあります。実際やってみると面白い動作をすることがわかりましたので紹介したいと思います。

# 正しい手順

SharePoint Online にアクセスします。タブ バーの **共有** をクリックします。

![](/images/2015_12_09_120000_001.png)

Microsoft アカウントのメール アドレスを入力して **共有** をクリックします。

![](/images/2015_12_09_120000_002.png)

**サイトの設定** - **アクセスの依頼と招待状** を見ると、先ほど入力したメール アドレスのユーザーに対して招待が行われていることがわかります。

![](/images/2015_12_09_120000_003.png)

Microsoft アカウントには通知のメールが届きます。

![](/images/2015_12_09_120000_004.png)

メールのリンクをクリックすると、ログインするアカウントを選択するようになっていますので、[Microsoft アカウント] を選択します。

![](/images/2015_12_09_120000_005.png)

Microsoft アカウントで SharePoint Online にアクセスできるようになりました。

![](/images/2015_12_09_120000_006.png)

Office 365 の管理ポータルから見ると **アクティブなユーザー** に Microsoft アカウントが追加されているのがわかります。

![](/images/2015_12_09_120000_007.png)

# 正しくない手順

Office 365 のユーザー情報は Azure AD で管理されています。Azure のサブスクリプションがあれば、Azure ポータルからもユーザーを追加することができます。そして、Azure ポータルでは Microsoft アカウントを持つユーザーを登録することができます。
SharePoint Online から招待されたユーザーと Azure から登録したユーザーはどちらもソースは同じように表示されます。

![](/images/2015_12_09_120000_008.png)

Azure から登録したユーザーを SharePoint Online で共有してみます。
正しい手順と比べてみて違いがわかるでしょうか。正しくない手順の場合、組織外のユーザーというメッセージが表示されていません。

![](/images/2015_12_09_120000_009.png)

ログインしようとするとエラーとなります。

![](/images/2015_12_09_120000_010.png)

# おわりに

サイトを共有するときに組織外のユーザーというメッセージが表示されていないことからわかる通り、Azure から登録した Microsoft アカウントは組織内のユーザーとして登録されます。Office 365 の管理ポータルを見ても、組織内のユーザーであるため、プロフィールの編集やライセンスの割り当てができることがわかります。

![](/images/2015_12_09_120000_011.png)

組織内か組織外かというフラグを Azure AD のプロパティとして持っているのでしょうが、ちょっと見た感じでは違いがわからないので、はまってしまうと思います。
まとめると以下のようになります。

- SharePoint Online から招待された Microsoft アカウントのユーザーは組織外ユーザーとして Azure AD に登録される
- Azure から登録された Microsoft アカウントのユーザーは組織内ユーザーとして Azure AD に登録される
- Azure ポータルからはユーザーが組織内か組織外かどうかは判断できない
- Office 365 管理ポータルからはユーザーを選択したときに組織内か組織外かどうかを判断できる

# おまけ

以下のことをすると、Azure から登録された組織内アカウントを使うことができます。

- ユーザー名から **#EXT#** を削除する
- パスワードをリセットする
- SharePoint Online のライセンスを割り当てる
