---
title: "Office 365 日本リージョンで Microsoft Graph data connect を実行するとエラーになる"
emoji: "💻"
type: "tech"
topics: ["microsoftgraph"]
published: true
---

:::message
この記事ははてなブログに 2018/10/19 に投稿したものの転載です。
:::

ここ数日 Microsoft Graph data connect を試そうと思っていろいろやってみたのですがどうにもうまくいかないということで。

現在 OfficeDev の GitHub リポジトリにはセットアップの手順とサンプルの ARM Template が公開されています。

https://github.com/OfficeDev/MS-Graph-Data-Connect

また Microsoft Graph の GitHub リポジトリにはトレーニング用のコンテンツが公開されています。

https://github.com/microsoftgraph/msgraph-training-dataconnect

頑張って英語を読み解きながらどちらの手順を試してみたもののできませんでした。発生したエラーについては以下の通り。Office 365 への承認までは通るのですがその後で固まってしまう感じ。

> Error: Office365 data loading failed to execute. Failed to extract data from Office 365 for Tenant and dataset BasicDataSet_v0.Contact_v0 into AzureBlobStorage

仕方がないので開発チームにメールを投げてみることに。次の日には返事がきました。どうも Office 365 のリージョンと Blob Storage のリージョンの組み合わせが正しくないとエラーになるとのこと。

https://github.com/OfficeDev/MS-Graph-Data-Connect/wiki/Capabilities#data-regions

そして日本リージョンがない件。さらに突っ込んで聞いてみたところ、日本リージョンではまだサポートされておらず、2019 年前半には日本 (Office 365) - 東日本 (Azure) で使えるようになるそうです。それまではアジア太平洋 (Office 365) - 東南アジア (Azure) を使って欲しいとのことでした。とりあえず日本で試すことができるのはまだまだ先のようですね。
