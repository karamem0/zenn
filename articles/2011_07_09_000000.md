---
title: "DirectorySearcher ã® PageSize ã¨ SizeLimit ã‚’ã„ã˜ã£ã¦ã¿ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["csharp"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2011/7/9 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

å‰å›ã®è¨˜äº‹ã®ç¶šãã§ã™ã€‚

https://zenn.dev/karamem0/articles/2011_06_28_000000

Active Directory ã®ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ—æŒ™ã™ã‚‹æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚

```csharp
public static class Program
{

    private static void Main(string[] args)
    {
        using (var entry = new DirectoryEntry("LDAP://example.com/DC=example,DC=com"))
        using (var searcher = new DirectorySearcher(entry))
        {
            searcher.Filter = "(objectClass=user)";
            using (var result = searcher.FindAll())
            {
                foreach (var user in result
                    .Cast<SearchResult>()
                    .Select(x => x.GetDirectoryEntry())) {
                    Console.WriteLine(user.Properties["name"].Value);
                }
            }
        }
        Console.ReadKey();
    }

}
```

å®Ÿã¯ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ä¸å…·åˆãŒã‚ã‚Šã¾ã™ã€‚ã¨ã„ã†ã®ã‚‚ã€Active Directory ã® LDAP æ¤œç´¢ã§ã¯ 1000 ä»¶ã¾ã§å–å¾—ã§ããªã„ã¨ã„ã†åˆ¶é™ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚

https://docs.microsoft.com/ja-jp/dotnet/api/system.directoryservices.directorysearcher

ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ `PageSize` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« 0 ä»¥ä¸Šã®å€¤ã‚’è¨­å®šã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€å†…éƒ¨çš„ã«ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãŒè¡Œã‚ã‚Œã€ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¿”ã•ã‚Œã¾ã™ã€‚
ã¾ãŸã€æŒ‡å®šã—ãŸä»¶æ•°ã®ã¿å–ã‚Šå‡ºã—ãŸã„å ´åˆã¯ã€`SizeLimit` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã„ã¾ã™ã€‚ãŸã ã—ã€`SizeLimit` ãŒæœ‰åŠ¹ã«ãªã‚‹ã®ã¯ã€`PageSize` ãŒ 0 ã¾ãŸã¯ `PageSize > SizeLimit` ã®å ´åˆã§ã€`SizeLimit` ã¯ 1000 ã¾ã§ã—ã‹æœ‰åŠ¹ã«ãªã‚Šã¾ã›ã‚“ã€‚Microsoft Docs ã«ã‚‚ã€

https://docs.microsoft.com/ja-jp/dotnet/api/system.directoryservices.directorysearcher.sizelimit#remarks

> If you set SizeLimit to a value that is larger than the server-determined default of 1000 entries, the server-determined default is used.

ã¨ã‚ã‚‹ã®ã§ã€ãã®é€šã‚Šã ã¨æ€ã†ã®ã§ã™ãŒã€1000 ä»¶ã‚’è¶…ãˆã‚‹å ´åˆã§ä»¶æ•°çµã‚ŠãŸã„ã¨ãã¯å›°ã‚‹ãªã‚ã¨æ€ã£ãŸã‚Šã€‚å†…éƒ¨ã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã—ã¦ãªã‘ã‚Œã°ä½•ã¨ã‹ã§ããã†ã§ã¯ã‚ã‚‹ã®ã§ã™ãŒã€‚
