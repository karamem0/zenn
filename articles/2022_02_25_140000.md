---
title: "Power Platform の仮想ネットワーク データ ゲートウェイについて"
emoji: "💻"
type: "tech"
topics: ["powerapps", "powerbi"]
published: true
---

# はじめに

Power BI や Power Apps のデータフローから Azure のリソースに接続する場合、Azure のリソースはパブリック ネットワークに存在する必要があります。しかし SQL Database や Blob Storage をパブリック ネットワークに公開するのはセキュリティを考慮するとあまり現実的ではありません。SQL Database や Blob Storage は仮想ネットワーク (VNet) に閉じ込めておき、必要なリソースからのみアクセスさせるということになります。オンプレミス データ ゲートウェイを使ってアクセスさせるという方法もありますが、ゲートウェイとなる仮想マシンを用意しなければならず、なかなか大変です。

こういう状況もあってか、新たに仮想ネットワークデータ ゲートウェイという方法がプレビューで提供されています。これを使うとゲートウェイを用意することなく仮想ネットワークにアクセスすることができます。要するに VNet 統合の Power Platform 版ですね。

基本的な情報は Microsoft Docs にまとまっています。

https://docs.microsoft.com/ja-jp/data-integration/vnet/overview?WT.mc_id=M365-MVP-5002941

# 構築方法

今回はデータフローから仮想ネットワークにある Blob Storage に接続してみたいと思います。まずは仮想ネットワークに接続する Blob Storage を作成します。

![](/images/2022_02_25_140000_001.png)

Blob Storage を作成した Azure サブスクリプションの **リソース プロバイダー** として `Microsoft.PowerPlatform` を登録します。

![](/images/2022_02_25_140000_002.png)

仮想ネットワークの未使用のサブネットに **サブネットの委任** として `Microsoft.PowerPlatform/vnetaccesslinks` を追加します。

![](/images/2022_02_25_140000_003.png)

Power Platform 管理センターの **データ (プレビュー)** - **仮想ネットワーク ゲートウェイ** で **仮想ネットワーク データ ゲートウェイを作成します。** をクリックします。先ほど委任を指定したサブネットを選択して **保存** をクリックします。

![](/images/2022_02_25_140000_004.png)


データフローからデータ ソースとして **Azure BLOB** を選択します。**データ ゲートウェイ** に作成した仮想ネットワーク ゲートウェイが選択できるようになります。

![](/images/2022_02_25_140000_005.png)

# おわりに

実際に試してみていくつか注意点があります。

- 仮想ネットワーク ゲートウェイが使用可能なのはPower BI と Power Apps のデータフローです。Power Apps や Power Automate のコネクタとしては利用できません。また Power BI の場合は Power BI Premium のみ利用できます。
- Power Platform のテナントと Azure のテナントは同じである必要があります。
- 仮想ネットワーク ゲートウェイを作成するユーザーが Azure のリソースへのアクセス許可を持っている必要があります。

https://docs.microsoft.com/ja-jp/data-integration/vnet/use-data-gateways-sources-power-bi?WT.mc_id=M365-MVP-5002941
