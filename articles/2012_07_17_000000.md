---
title: "knockout.js ã‚’ä½¿ã£ã¦æ¤œç´¢ã‚’ã—ã¦ã¿ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["csharp", "javascript"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2012/7/17 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

# ã¯ã˜ã‚ã«

å‰ã®è¨˜äº‹ã¨ã ã„ã¶æ™‚é–“ãŒç©ºã„ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€å¼•ãç¶šã knockout.js ã‚’å¼„ã£ã¦ã¿ã¾ã™ã€‚

https://zenn.dev/karamem0/articles/2012_07_17_000000

ä»Šå›ã¯æ¤œç´¢ã‚’ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# ã‚³ãƒ¼ãƒ‰ã®è¨˜è¿°

## Models/Person.cs

ç°¡å˜ãª Model ã‚’ä½œæˆã—ã¾ã™ã€‚

```csharp
public class Person
{

    public string Id { get; set; }
    public string Name { get; set; }
    public int Age { get; set; }

}
```

## Controllers/HomeController.cs

Controller ã®å®Ÿè£…ã¯ã€å˜ç´”ã«æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’å—ã‘å–ã£ã¦çµæœã‚’ JSON ã§è¿”ã—ã¦ã„ã¾ã™ã€‚

```csharp
public class HomeController : Controller
{

    public ActionResult Index()
    {
        return this.View();
    }

    [HttpPost()]
    public JsonResult Index(string id, string name, int? age)
    {
        var data = new[]
        {
            new Person() { Id = "1", Name = "ä½è—¤å¤ªéƒ", Age = 30, },
            new Person() { Id = "2", Name = "å±±ç”°æ¬¡éƒ", Age = 15, },
            new Person() { Id = "3", Name = "é«˜æ©‹ä¸‰éƒ", Age = 60, },
            new Person() { Id = "4", Name = "ç”°ä¸­å››éƒ", Age = 55, },
            new Person() { Id = "5", Name = "éˆ´æœ¨äº”éƒ", Age = 45, }
        };
        return this.Json(
            data.Where(x => string.IsNullOrEmpty(id) || x.Id == id)
                .Where(x => string.IsNullOrEmpty(name) || x.Name.Contains(name))
                .Where(x => age == null || x.Age == age)
        );
    }

}
```

## Views/Home/Index.cshtml

View ã®å®Ÿè£…ã§ã™ã€‚knockout.js ã‚’ä½¿ã£ã¦æ¤œç´¢ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã« `search` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é€£çµã—ã¾ã™ã€‚jQuery ã® `serializeArray` ãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒ•ã‚©ãƒ¼ãƒ ã®è¦ç´ ã‚’ JSON ã«ã—ã¦ã„ã¾ã™ã€‚

```html
@model Karamem0.samples.Models.Person
@{
    ViewBag.Title = "ãƒ›ãƒ¼ãƒ  ãƒšãƒ¼ã‚¸";
}
@using (Html.BeginForm()) {
    <table>
        <tr>
            <td><span class="editor-label">@Html.LabelFor(model => model.Id)</span></td>
            <td><span class="editor-field">@Html.TextBoxFor(model => model.Id)</span></td>
        </tr>
        <tr>
            <td><span class="editor-label">@Html.LabelFor(model => model.Name)</span></td>
            <td><span class="editor-field">@Html.TextBoxFor(model => model.Name)</span></td>
        </tr>
        <tr>
            <td><span class="editor-label">@Html.LabelFor(model => model.Age)</span></td>
            <td><span class="editor-field">@Html.TextBoxFor(model => model.Age)</span></td>
        </tr>
    </table>
    <input type="button" value="æ¤œç´¢" data-bind="click: search" />
    <div data-bind="foreach: items">
        <div>
            <span data-bind="text: Id"></span>
            <span data-bind="text: Name"></span>
            <span data-bind="text: Age"></span>
        </div>
    </div>
}
<script type="text/javascript">
    $(function () {
        var viewModel = {
            items: ko.observableArray([]),
            search: function () {
                var self = this;
                var param = $("form :input").serializeArray();
                var callback = function (data) {
                    self.items.removeAll();
                    $.each(data, function (i, e) {
                        self.items.push(e);
                    });
                };
                $.post("@Url.Action("Index")", param, callback, "json");
            }
        };
        ko.applyBindings(viewModel);
    });
</script>
```

# å®Ÿè¡Œçµæœ

åå‰ã§æ¤œç´¢ã—ã¦ã¿ã¾ã™ã€‚

![](/images/2012_07_17_000000_001.png)

ã¡ã‚ƒã‚“ã¨æ¤œç´¢ã§ãã¾ã—ãŸï¼

![](/images/2012_07_17_000000_002.png)

# ãŠã‚ã‚Šã«

ã¡ãªã¿ã«ä½•ã‚‚å…¥ã‚Œãªã‘ã‚Œã°å…¨éƒ¨å‡ºã¦ãã¾ã™ã€‚
