---
title: "IIS Express をバックグラウンドで実行する"
emoji: "💻"
type: "tech"
topics: ["vb"]
published: true
---

:::message
この記事ははてなブログに 2014/12/2 に投稿したものの転載です。
:::

この記事は **Visual Basic Advent Calendar 2014** の参加記事です。

https://qiita.com/advent-calendar/2014/vb

いろいろあって現在は PHP の開発に IIS Express と NetBeans を使うことで落ち着いています。これでほとんど困っていないのですが、唯一問題なのが、IIS Express を手動で立ち上げないといけないということだったりします。今まではコマンド プロンプトでこんな感じに実行していました。

```cmd
"C:\Program Files (x86)\IIS Express\iisexpress.exe" /siteid:8091
```

これでもいいのですが、コマンド プロンプトを閉じると IIS Express が終了してしまうのと、複数サイトをあげるときはそれぞれコマンド プロンプト開かなくていけないので、面倒だったりします。できればサービスみたいにバックグランドで実行したいので、VBScript を使ってみました。

```vb
Set Shell = CreateObject("Wscript.Shell") 
Shell.Run "cmd /C ""C:\Program Files (x86)\IIS Express\iisexpress.exe"" /siteid:8091", vbHide
Shell.Run "cmd /C ""C:\Program Files (x86)\IIS Express\iisexpress.exe"" /siteid:8092", vbHide
```

`WshShell.Run` メソッドの `intWindowStyle` に `vbHide` を指定しているので非表示の状態で実行されます。なお、IIS Express を終了したい場合は、通知領域アイコンに常駐している `iisexpresstray.exe` から終了させることができます。
