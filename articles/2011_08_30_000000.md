---
title: "SharePoint 2013 アプリケーション ページで Web.config を使用する"
emoji: "💻"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2011/8/30 に投稿したものの転載です。
:::

# はじめに

SharePoint 2013 のアプリケーション ページは **空の SharePoint プロジェクト** というテンプレートから作るため、初期状態ではまったくファイルが存在しない状態ですが、`Web.config` を配置することができます。ただし、ちょっとした工夫が必要になります。

# サンプル コード

https://github.com/karamem0/samples/tree/main/sharepoint-farm-solution-with-config

## Web.config の追加

空の SharePoint プロジェクトを作成し、アプリケーション ページ (`ApplicationPage1.aspx`) を作成します。ソリューション エクスプローラーで `ApplicationPage1.aspx` が保存されたフォルダーを右クリックし、コンテキスト メニューから **追加** - **新しい項目** をクリックします。**新しい項目の追加** のテンプレートの一覧には、通常の ASP.NET アプリケーションでは存在する **Web 構成ファイル** がないので、**アプリケーション構成ファイル** を選択し `Web.config` と名前を変更します。

作成された `Web.config` を編集します。

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <appSettings>
        <add key="Message" value="Hello SharePoint" />
    </appSettings>
</configuration>
```

## コードの記述

参照設定に `System.Configuration.dll` を追加して、`ApplicationPage1.aspx` を編集します。

```html
<%@ Import namespace="System.Configuration" %>
<asp:Content id="Main" contentplaceholderid="PlaceHolderMain" runat="server">
    <h1><%# ConfigurationManager.AppSettings["Message"] %></h1>
</asp:Content>
```

# 実行結果

デバッグを開始すると以下のように表示されます。

![](/images/2011_08_30_000000_001.png)

# おわりに

注意点としては、アプリケーション ページの `Web.config` は、ASP.NET Web アプリケーションのサブ フォルダーにある `Web.config` として配置されるので、すべての機能 (HTTP モジュールの登録など) が使えるわけではありません。ルートの `Web.config` は既定で `C:\inetpub\wwwroot\wss\VirtualDirectories\{{port-number}}` にあるので、こちらを編集することもできますが、アプリケーション全体に影響を与えてしまうので注意が必要です。
