---
title: "knockout.js ã® observableArray ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰æ¤œè¨¼ã‚’æœ‰åŠ¹ã«ã™ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["javascript"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2012/10/4 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

`ko.observableArray` ã§ãƒã‚¤ãƒ³ãƒ‰ã—ãŸãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‹ã‘ã‚ˆã†ã¨æ€ã£ãŸã®ã§ã™ãŒã€æ™®é€šã«ã‚„ã£ãŸã ã‘ã§ã¯ã†ã¾ãå‹•ã„ã¦ãã‚Œãªã„ã‚ˆã†ã§ã™ã€‚knockout.js ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ Knockout Validation ã¨ã„ã†ã®ã‚‚ã‚ã‚‹ã‚ˆã†ãªã®ã§ã™ãŒã€

- ãã‚‚ãã‚‚ `ko.observableArray` ã«å¯¾å¿œã—ã¦ãªã„ (ãã‚Œãã‚Œã®è¦ç´ ã« `ko.observable` ã™ã‚‹å¿…è¦ãŒã‚ã‚‹)
- jquery.validate.unobtrusive.js ã«å¯¾å¿œã—ã¦ãªã„ (è‡´å‘½çš„ï¼)

ã¨ã„ã†ã“ã¨ã§ã€è¦‹äº‹ã«æ–­å¿µã—ã¦ã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚

èª°ã‚‚ä½œã‚‰ãªã„ãªã‚‰è‡ªåˆ†ã§ä½œã‚‹ã—ã‹ãªã„ï¼ã¨ã„ã†ã“ã¨ã§ã€knockout.js ã®ã‚«ã‚¹ã‚¿ãƒ ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚

```javascript
$(function () {
    ko.bindingHandlers.validate = {
        update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
            if (valueAccessor()) {
                $.validator.unobtrusive.parse(element);
            }
        }
    };
});
```

`$.validator.unobtrusive.parse` ãƒ¡ã‚½ãƒƒãƒ‰ã«è¦ç´ ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å‹•çš„ã«è¿½åŠ ã—ãŸãƒ•ã‚©ãƒ¼ãƒ ã®æ¤œè¨¼ã‚’æœ‰åŠ¹ã«ã—ã¦ãã‚Œã‚‹ã‚‰ã—ã„ã§ã™ã€‚ã‚ã¨ã¯ã€ãƒã‚¤ãƒ³ãƒ‰ã—ã¦ã‚ã’ã‚Œã°å®Œæˆã§ã™ã€‚

```html
@{
    ViewBag.Title = "ãƒ›ãƒ¼ãƒ ";
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();
}
<form action="/" method="post">
    <input type="button" value="è¿½åŠ " data-bind="click: add" />
    <input type="button" value="é€ä¿¡" data-bind="click: submit" />
</form>
<fieldset id="Items" data-bind="foreach: items">
    @using (Html.BeginForm("Index", null, FormMethod.Post,
        new Dictionary<string, object>() { { "data-bind", "validate: true" } })) {
        @Html.ValidationSummary()
        <table>
            <tbody>
                <tr>
                    <td class="editor-label">
                        <span>åå‰:</span>
                    </td>
                    <td class="editor-field">
                        <input id="Name" name="Name" type="text" data-bind="value: name" data-val="true" data-val-required="åå‰ã¯å¿…é ˆã§ã™ã€‚" />
                    </td>
                    <td class="editor-label">
                        <span>å¹´é½¢:</span>
                    </td>
                    <td class="editor-field">
                        <input id="Age" name="Age" type="text" data-bind="value: age" data-val="true" data-val-number="å¹´é½¢ã¯æ•°å€¤ã§ã™ã€‚" />
                    </td>
                </tr>
            </tbody>
        </table>
    }
</fieldset>
<script type="text/javascript">
    function ViewModel() {
        this.items = ko.observableArray([]);
        this.add = function () {
            this.items.push({ name: null, age: null });
        };
        this.submit = function () {
            var valid = Enumerable
                .From($("#Items").find("form"))
                .Select(function (form) { return $(form).valid() })
                .All(function (result) { return result });
        };
    };
    ko.applyBindings(new ViewModel());
    $(function () {
        ko.bindingHandlers.validate = {
            update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
                if (valueAccessor()) {
                    $.validator.unobtrusive.parse(element);
                }
            }
        };
    });
</script>
```
