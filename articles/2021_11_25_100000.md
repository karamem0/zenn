---
title: "Microsoft Graph Toolkit ã® Teams MSAL2 Provider ã«ã¤ã„ã¦"
emoji: "ğŸ’»"
type: "tech"
topics: ["microsoftgraph"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2021/11/25 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

Microsoft Graph Toolkit ã«ã¯ã„ãã¤ã‹ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒã‚ã£ã¦ SharePoint ã‚„ Microsoft Teams ãªã©ã®ã„ãã¤ã‹ã®ã‚·ãƒŠãƒªã‚ªã§ã¯æœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€Microsoft Teams ç”¨ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã‚·ãƒ³ã‚°ãƒ« ã‚µã‚¤ãƒ³ã‚ªãƒ³ã«å¯¾å¿œã—ã¦ãŠã‚‰ãšæ­£ç›´ã‚¤ã‚±ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã¨ã“ã‚ãŒæœ€è¿‘ã«ãªã£ã¦ Teams MSAL2 Provider ã¨ã„ã†ã®ãŒã§ãã¦ã‚·ãƒ³ã‚°ãƒ« ã‚µã‚¤ãƒ³ã‚ªãƒ³ã«ã‚‚å¯¾å¿œã—ãŸã‚‰ã—ã„ã§ã™ã€‚ãŸã ã—è‚å¿ƒã®ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›ã®ã¨ã“ã‚ã¯ã€Œã‚µãƒ³ãƒ—ãƒ« ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã­ã€ã¨æ›¸ã„ã¦ã‚ã‚‹ã®ã«ãƒªãƒ³ã‚¯å…ˆã«ã¯ä¸€åˆ‡ã®è¨˜è¼‰ãŒãªã„ã¨ã„ã†ã€‚[^1] ä»•æ–¹ãªã„ã®ã§ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

https://github.com/microsoftgraph/microsoft-graph-toolkit/blob/922affc7253550cdc5966629069b77f039565e1b/packages/providers/mgt-teams-msal2-provider/src/TeamsMsal2Provider.ts

ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›ã®ã¨ã“ã‚ã‚’æŠœãå‡ºã™ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚

```typescript
response = await fetch(url.href, {
  method: 'POST',
  headers: {
    Content-Type': 'application/json',
    authorization: `Bearer ${clientToken}`
  },
  body: JSON.stringify({
    scopes: scopes,
    clientid: this.clientId
  }),
  mode: 'cors',
  cache: 'default'
});

const data = await response.json().catch(this.unhandledFetchError);

...

return data.access_token;
```

ã†ãƒ¼ã‚“ã€ãªã‚“ã‹ç‹¬è‡ªã®å®Ÿè£…ã«ãªã£ã¦ã„ã¦ TeamsFx ã® SimpleAuth ã¨é€£æºã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã•ãã†ã§ã™ã€‚

https://github.com/OfficeDev/TeamsFx/tree/ga/packages/simpleauth

ã“ã†ã„ã†ã¨ã“ã‚ã¯ã¡ã‚ƒã‚“ã¨ã‚„ã£ã¦ã»ã—ã„ãªã‚ã¨æ€ã£ã¦ã„ãŸã‚‰ Issue ã¨ Pull Request ãŒä¸ŠãŒã£ã¦ã„ã¾ã—ãŸã€‚`next/teamsfx` ãƒ–ãƒ©ãƒ³ãƒã«å…¥ã£ã¦ã„ã‚‹ã®ã§è¿‘ã„å°†æ¥ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚

https://github.com/microsoftgraph/microsoft-graph-toolkit/tree/a19718867b0ff15a72b0491257720d3928bb878f/packages/providers/mgt-teamsfx-provider

ã“ã‚Œã¯ã‹ãªã‚Šä¾¿åˆ©ã«ãªã‚Šãã†ã§ã™ã­ï¼

[^1]: ã‚ˆãã‚ã‚‹ã“ã¨ã§ã™ã­ã€‚
