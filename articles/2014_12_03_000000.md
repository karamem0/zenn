---
title: "SQL Server Reporting Services のレポートでカスタム コードを埋め込む"
emoji: "💻"
type: "tech"
topics: ["vb"]
published: true
---

:::message
この記事ははてなブログに 2014/12/3 に投稿したものの転載です。
:::

# はじめに

この記事は **Visual Basic Advent Calendar 2014** の参加記事です。

https://qiita.com/advent-calendar/2014/vb

あまり知られていませんが、SQL Server の機能のひとつに SQL Server Reporting Services (SSRS) というのがあります。公式のレポート作成機能ですね。SQL Server Express でも SQL Server Express with Advanced Services をインストールすると、機能制限はあるものの、PDF を作成するくらいのことはできてしまいます。ちょっと凝ったことをやろうとすると Active Report などの製品には敵わないのですが、簡単な帳票であれば作成できてしまいます。
レポートの開発には無償で提供されているレポート ビルダーを使います。テーブルのデータは簡単に参照できるようになっており、VB ベースの基本的な関数も準備されているのですが、ある程度複雑なことをやろうとすると、カスタムのロジックを追加する必要があります。レポート ビルダーでは VB.NET のコードを埋め込んで参照することができます。

# 実行結果

レポート ビルダーの **レポートのプロパティ** を表示し、**コード** をクリックします。

![](/images/2014_12_03_000000_001.png)

カスタム コードを入力するテキスト ボックスにコードを記述します。ここでは `Hello World` という文字列を返すメソッドを定義します。

![](/images/2014_12_03_000000_002.png)

任意のテキストボックスの式に `=Code.HelloWorld()` と指定します。

![](/images/2014_12_03_000000_003.png)

プレビューで見てみると、ちゃんと表示されてますね。

![](/images/2014_12_03_000000_004.png)

# おわりに

ちなみに dll を参照設定して呼び出したりもできるそうです。
