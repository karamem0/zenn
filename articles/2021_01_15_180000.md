---
title: "Microsoft 365 に設定したプロフィール画像を削除する"
emoji: "💻"
type: "tech"
topics: ["azuread", "powershell"]
published: true
---

:::message
この記事ははてなブログに 2021/1/15 に投稿したものの転載です。
:::

Microsoft 365 に設定したプロフィール画像を削除したいという要望があったのですが、なかなか一筋縄ではいかなかったので備忘録としてメモしておきます。なお結論としては、現状としては GUI からは削除することはできず、PowerShell を使って削除する必要があります。

そもそもですが、Microsoft 365 でプロフィール画像を登録する場所は複数あります。

|場所|画像の登録|画像の削除|
|-|-|-|
|Azure ポータル|できる|できる|
|Microsoft 365 管理センター|できる|できない|
|Delve|できる|できない|
|Outlook|できる|できない|
|Microsoft Teams|できる|できる※|

画像の登録はいずれの場所で行ってもそれぞれのサービスに反映されるようです。ですが、画像の削除に関しては、そもそもできなかったり、ほかのサービスへの反映がされなかったりします。Microsoft Teams の場合は、削除をすると、イニシャル画像 (氏名が Takashi Shinohara であれば `TS` と表示される画像) が代わりに登録され、削除という動作にはなりません。ややこしいですね。

登録する場所はいろいろあるのですが、最終的に保存される場所は Azure AD と Exchange の 2 つのようです。ほかにも SharePoint のユーザー プロファイルというのもあるのですが、現在どこで使われているのかを見つけることができませんでした。それぞれの画像は PowerShell で確認できます。

|保存場所|コマンドレット|
|-|-|
|Azure AD|`Get-AzureADUserThumbnailPhoto`|
|Exchange|`Get-UserPhoto`|

Azure AD の画像は Azure ポータルから GUI で削除することができますが、PowerShell では削除することはできないようです。逆に Exchange の画像は GUI から削除できず、`Remove-UserPhoto` コマンドレットを実行する必要があります。

ということで、現時点で Microsoft 365 からプロフィール画像を完全に削除するには以下の手順で行います。

- Azure ポータルから画像を削除する
- `Remove-UserPhoto` コマンドレットを実行して画像を削除する
