---
title: "SharePoint Framework 1.4.1 で追加された MSGraphClient を試してみた"
emoji: "💻"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2018/2/19 に投稿したものの転載です。
:::

SharePoint Framework 1.4.1 が公開され、プレビューですが Graph API をサポートしました。

https://developer.microsoft.com/en-us/office/blogs/now-releasing-enhanced-preview-support-for-microsoft-graph-api-calls-from-sharepoint-framework?WT.mc_id=M365-MVP-5002941

これまでのバージョンでは、`GraphHttpClient` によって限定的な Graph API の呼び出しがサポートされてきましたが、今回のリリースでは、新しい SharePoint 管理センターから承認することで、任意のアクセス許可を与えることができます。
今回のリリースで追加されたのは `MSGraphClient` という名前になっており、モジュールも `@microsoft/sp-client-preview` になっています。

https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-msgraph?WT.mc_id=M365-MVP-5002941

追加のアクセス許可を取得する場合は、`package-solution.json` にアクセス許可を指定します。アプリ カタログ サイトに登録したときに、承認待ち状態でアプリが登録され、管理者が承認すると許可された API が使用できるようになります。

https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-aadhttpclient?WT.mc_id=M365-MVP-5002941

ちなみに、残念ながら `GraphHttpClient` とは違い OAuth で新しいウィンドウを開く動作となっていますが、ポップアップ ブロックが有効になっているときに親切にも教えてくれるようになりました。
