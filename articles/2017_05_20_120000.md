---
title: "SPClient 0.8 を公開しました"
emoji: "🔔"
type: "tech"
topics: ["news"]
published: true
---

:::message
この記事ははてなブログに 2017/5/20 に投稿したものの転載です。
:::

https://www.powershellgallery.com/packages/SPClient/0.8

データ取得で `*` による指定ができるようになりました。つまり、こんな風に呼び出せます。

```powershell
Get-SPClientWeb -Default -Retriavals "*,Lists.Include(*)"
```

これは内部的に以下のように変換されます。

```csharp
clientContext.Load(clientContext.Web, web => web, web => web.Lists.IncludeWithDefaultProperties(list => list))
```

また、データの取得において、キャッシュを使うのをやめました。これにより、コマンドの実行ごとにサーバーへのリクエストが発生することになり、パフォーマンスの劣化が想定されますが、キャッシュをすることによる弊害のほうが大きいため、このような変更となりました。ちなみに、SharePoint 2016 の CSOM ではキャッシュの有無を指定できるようになっているようです。ぐぬぬ。
