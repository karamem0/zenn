---
title: "PowerShell ã¨ CSOM ã§ Geolocation åˆ—ã«å€¤ã‚’å…¥ã‚Œã‚‹ã¨ãã«ã¡ã‚‡ã£ã¨ãƒãƒã£ãŸã®ã§ãƒ¡ãƒ¢"
emoji: "ğŸ’»"
type: "tech"
topics: ["powershell", "sharepoint"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2019/3/1 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

ç›¸å¤‰ã‚ã‚‰ãš PowerShell ãªã‚“ã§ã™ã‘ã‚Œã©ã‚‚ã€‚

`Geolocation` åˆ—ã«å€¤ã‚’å…¥ã‚Œã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã€‚`FieldGeolocationValue` ã‚’ä½¿ã£ã¦ã­ã¨ã„ã†ã“ã¨ã®ã‚ˆã†ã§ã™ã€‚

https://docs.microsoft.com/en-us/sharepoint/dev/general-development/how-to-add-a-geolocation-column-to-a-list-programmatically-in-sharepoint?WT.mc_id=M365-MVP-5002941

ãã‚Œã§ã¯å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã¾ã™ã€‚

```powershell
$item = New-Object Microsoft.SharePoint.Client.ListItemCreationInformation
$item = $list.AddItem($item)

$value = New-Object Microsoft.SharePoint.Client.FieldGeolocationValue
$value.Latitude = 10
$value.Longitude = 10
$item["Location"] = $value

$item.Update()
$ctx.Load($item)
$ctx.ExecuteQuery()
```

å®Ÿè¡Œã™ã‚‹ã¨ï¼Ÿ

```
"0" å€‹ã®å¼•æ•°ã‚’æŒ‡å®šã—ã¦ "ExecuteQuery" ã‚’å‘¼ã³å‡ºã—ä¸­ã«ä¾‹å¤–ãŒç™ºç”Ÿã—ã¾ã—ãŸ: "The geolocation value does not represent a geo graphical point. Either the value is not in the correct format or it is not in the valid range."
ç™ºç”Ÿå ´æ‰€ è¡Œ:1 æ–‡å­—:1
+ $ctx.ExecuteQuery()
+ ~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : ServerException
```

æ­£è§£ã¯ã“ã£ã¡ã€‚å€¤ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã—ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```powershell
$item = New-Object Microsoft.SharePoint.Client.ListItemCreationInformation
$item = $list.AddItem($item)

$value = New-Object Microsoft.SharePoint.Client.FieldGeolocationValue
$value.Latitude = 10
$value.Longitude = 10
$item["Location"] = [Microsoft.SharePoint.Client.FieldGeolocationValue]$value

$item.Update()
$ctx.Load($item)
$ctx.ExecuteQuery()
```

ã¡ãªã¿ã« `FieldLookupValue` ã‚„ `FieldUserValue` ã§ã‚‚åŒã˜ç¾è±¡ãŒç™ºç”Ÿã—ã¾ã™ã€‚ã‚‚ã£ã¨ã‚‚ã“ã¡ã‚‰ã¯ ID ã‚’æŒ‡å®šã—ã¦æ›´æ–°ã§ãã‚‹ã®ã§ä½¿ã‚ãªã„ã¨ã„ã†æ‰‹ã‚‚ã‚ã‚Šã¾ã™ã‘ã©ã€‚
