---
title: "CSOM „ÅßÂÆüË°å„Åï„Çå„Çã Web „É™„ÇØ„Ç®„Çπ„Éà„ÇíÂèñÂæó„Åô„Çã"
emoji: "üíª"
type: "tech"
topics: ["csharp", "sharepoint"]
published: true
---

:::message
„Åì„ÅÆË®ò‰∫ã„ÅØ„ÅØ„Å¶„Å™„Éñ„É≠„Ç∞„Å´ 2017/5/15 „Å´ÊäïÁ®ø„Åó„Åü„ÇÇ„ÅÆ„ÅÆËª¢Ëºâ„Åß„Åô„ÄÇ
:::

CSOM „Åß„ÅØÂÜÖÈÉ®ÁöÑ„Å´ Web „É™„ÇØ„Ç®„Çπ„Éà„ÇíÁô∫Ë°å„Åó„Å¶„ÅÑ„Å¶„ÄÅ„Å©„ÅÜ„ÅÑ„ÅÜ„É™„ÇØ„Ç®„Çπ„Éà„ÅåÊµÅ„Çå„Å¶„ÅÑ„Çã„Åã„ÇíË¶ã„Çã„Åü„ÇÅ„Å´„ÅØ `Fiddler` „Å™„Å©„ÅÆ„ÉÑ„Éº„É´„Çí‰Ωø„Çè„Å™„ÅÑ„Å®„ÅÑ„Åë„Å™„ÅÑ„ÅÆ„Åß„Åô„Åå„ÄÅ„Å®„Å¶„ÇÇÈù¢ÂÄí„Åè„Åï„ÅÑ„ÅÆ„Åß„ÄÅ„Ç≥„Éº„Éâ„Åã„ÇâÂèñÂæó„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Å¶„Åø„Åæ„Åó„Åü„ÄÇ„Å°„Å™„Åø„Å´ `ExecutingWebRequest` „Ç§„Éô„É≥„Éà„ÅßÂèñ„Çå„Çã `e.WebRequestExecutor.GetRequestStream` „ÅØ `CanRead` „Åå `false` „Å™„ÅÆ„ÅßË™≠„ÅøÂèñ„Çä„Åß„Åç„Åæ„Åõ„Çì„ÄÇ„Å™„ÅÆ„Åß„É™„Éï„É¨„ÇØ„Ç∑„Éß„É≥„Åß„Åî„Å´„Çá„Åî„Å´„Çá„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ

```csharp
public static class Program
{

    private static void Main(string[] args)
    {
        var url = "{{site-url}}";
        var userName = "{{user-name}}";
        var rawPassword = "{{password}}";
        var securePasseord = new SecureString();
        foreach (var c in rawPassword)
        {
            securePasseord.AppendChar(c);
        }
        using (var ctx = new ClientContext(url))
        {
            ctx.Credentials = new SharePointOnlineCredentials(userName, securePasseord);
            ctx.ExecutingWebRequest += (sender, e) =>
            {
                var clientRequestType = ctx.PendingRequest.GetType();
                var buildQueryMethod = clientRequestType.GetMethod("BuildQuery", BindingFlags.Instance | BindingFlags.NonPublic);
                var chunkStringBuilderObject = buildQueryMethod.Invoke(ctx.PendingRequest, null);
                var chunkStringBuilderType = chunkStringBuilderObject.GetType();
                var createTextReaderMethod = chunkStringBuilderType.GetMethod("CreateTextReader", BindingFlags.Instance | BindingFlags.Public);
                var textReader = createTextReaderMethod.Invoke(chunkStringBuilderObject, null) as TextReader;
                Console.WriteLine(textReader.ReadToEnd());
            };
            var web = ctx.Web;
            ctx.Load(web);
            ctx.ExecuteQuery();
        }
        Console.ReadLine();
    }

}
```

ÂÆüË°å„Åô„Çã„Å®„Åì„Çì„Å™ÊÑü„Åò„ÄÇ

```xml
<Request AddExpandoFieldTypeSuffix="true" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName=".NET Library" xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009">
    <Actions>
        <ObjectPath Id="2" ObjectPathId="1" />
        <ObjectPath Id="4" ObjectPathId="3" />
        <Query Id="5" ObjectPathId="3">
            <Query SelectAllProperties="true">
                <Properties />
            </Query>
        </Query>
    </Actions>
    <ObjectPaths>
        <StaticProperty Id="1" TypeId="{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}" Name="Current" />
        <Property Id="3" ParentId="1" Name="Web" />
    </ObjectPaths>
</Request>
```
