---
title: "SharePoint Online の REST API を UWP から実行する"
emoji: "💻"
type: "tech"
topics: ["sharepoint", "uwp"]
published: true
---

:::message
この記事ははてなブログに 2016/6/5 に投稿したものの転載です。
:::

# はじめに

UWP から SharePoint Online REST API を実行するサンプルを作りました。出退勤の打刻を SharePoint リストに送るプログラムです。OAuth を使っているので認証から API 実行までの流れが確認できると思います。なおアクセス トークンの更新には対応していません。

# サンプル コード

https://github.com/karamem0/samples/tree/main/sharepoint-rest-authorization-code-flow

# 実行方法

以下のサイトを参考に Client ID と Client Secret を取得して `AuthPage.xaml.cs` に保存します。

https://blog.freedom-man.com/sharepoint_restapi

リポジトリにある `CreateList.ps1` を実行します。実行すると SharePoint サイトに **タイム レコーダー** というカスタム リストが作成されます。

# 実行結果

実行すると SharePoint サイトを指定する画面が出るので URL を入力します。

![](/images/2016_06_05_000000_001.png)

Office 365 にログインする画面が表示されるのでアカウント名とパスワードを入力してログインします。

![](/images/2016_06_05_000000_002.png)

アクセス許可を確認する画面が出るので **信頼する** をクリックします。

![](/images/2016_06_05_000000_003.png)

**出勤** または **退勤** をクリックすると SharePoint リストにリスト アイテムが追加されます。

![](/images/2016_06_05_000000_004.png)

リスト アイテムが追加された結果が確認できます。

![](/images/2016_06_05_000000_005.png)
