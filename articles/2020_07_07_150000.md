---
title: "Power Automate と Adaptive Cards で勤怠連絡アプリを作ってみる"
emoji: "💻"
type: "tech"
topics: ["adaptivecards", "powerautomate"]
published: true
---

:::message
この記事ははてなブログに 2020/7/7 に投稿したものの転載です。
:::

Microsoft Teams と Power Automate を Adaptive Cards で連携させてみたかったので勉強がてら勤怠連絡アプリを作ってみました。

全体像はこんな感じ。毎日 9 時にタイマーで起動して Microsoft Teams のチャットに Adaptive Cards を投稿し応答の結果を Excel ファイルに保存します。名前を変えてしまったのでわかりにくいですが Microsoft Teams に投稿するのは **アダプティブ カードを Teams ユーザーに投稿して応答を待機** というアクションです。

![](/images/2020_07_07_150000_001.png)

Adaptive Cards は Designer で作成します。ラジオ ボタンで選択した結果を `Submit` することで Power Automate に結果が返ってきます。

![](/images/2020_07_07_150000_002.png)

実際に実行してみます。Microsoft Teams のチャットに Adaptive Cards が送られてきます。

![](/images/2020_07_07_150000_003.png)

回答するとカードが更新されます。

![](/images/2020_07_07_150000_004.png)

結果は本文の `data` に入ってきますので `body('{{action-name}}')?['data']?['{{id}}']` のような式で後続のアクションから選択された項目を取得することができます。

![](/images/2020_07_07_150000_005.png)

結果が Excel に登録されているのがわかります。

![](/images/2020_07_07_150000_006.png)

例えばチーム内で勤怠管理するくらいならこれで十分な感じがありますね。
