---
title: "å‰Šé™¤ã§ããªããªã£ãŸ SharePoint 2013 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å¼·åˆ¶çš„ã«å‰Šé™¤ã™ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2019/9/2 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

SharePoint Designer ã§ SharePoint 2013 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é–‹ç™ºã—ã¦ã„ã‚‹ã¨ã¾ã‚Œã«ä½œæˆã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å‰Šé™¤ã§ããªããªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€å†åˆ©ç”¨å¯èƒ½ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ä¿å­˜ã—ã€ä¿å­˜ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰å±•é–‹ã—ãŸå ´åˆã«ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå‰Šé™¤ã§ããªããªã‚‹ã“ã¨ãŒç¢ºèªã§ãã¦ã„ã¾ã™ã€‚ã“ã®å ´åˆã€SharePoint Designer ã§å‰Šé™¤ã§ããªã„ã ã‘ã§ãªãã€CSOM ã‹ã‚‰ `WorkflowDeploymentService.DeleteDefinition` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã‚‚å‰Šé™¤ã§ãã¾ã›ã‚“ã€‚
å‰Šé™¤ã§ããªã„ã¨æœ€æ‚ªã‚µã‚¤ãƒˆã®ä½œã‚Šç›´ã—ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã®ã§ã€é ‘å¼µã£ã¦ç„¡ç†ã‚„ã‚Šå‰Šé™¤ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

ã¾ãšã€SharePoint 2013 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æƒ…å ±ã¯ã©ã“ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‹ã¨ã„ã†ã¨ `wfsvc` ã¨ã„ã†éš ã—ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‚Šã¾ã™ã€‚`wfsvc` ã¯ GUI ã‹ã‚‰ã‚‚ SharePoint Designer ã‹ã‚‰ã‚‚è¦‹ãˆã¾ã›ã‚“ãŒã€CSOM ã‹ã‚‰ã§ã‚ã‚Œã°ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è©¦ã—ã« SharePoint Designer ã§ SharePoint 2013 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚

![](/images/2019_09_02_190000_001.png)

CSOM ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

```powershell
Add-Type -LiteralPath "$PSScriptRoot\Microsoft.SharePoint.Client.dll"
Add-Type -LiteralPath "$PSScriptRoot\Microsoft.SharePoint.Client.Runtime.dll"

$siteurl = "{{site-url}}"
$username = "{{user-name}}"
$password = "{{password}}"

$password = ConvertTo-SecureString $password -AsPlainText -Force
$credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($username, $password)
$context = New-Object Microsoft.SharePoint.Client.ClientContext($siteurl)
$context.Credentials = $credentials

$web = $context.Web
$context.Load($web)
$context.ExecuteQuery()

$list = $web.GetList($web.ServerRelativeUrl.TrimEnd("/") + "/wfsvc")
$query = New-Object Microsoft.SharePoint.Client.CamlQuery
$query.ViewXml = '<View Scope="RecursiveAll"></View>'
$items = $list.GetItems($query)
$context.Load($items)
$context.ExecuteQuery()

foreach ($item in $items) {
    Write-Output ([pscustomobject]@{ Path = $item["FileRef"]; Name =  $item["WSDisplayName"] })
}
```

å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªçµæœãŒè¿”ã£ã¦ãã¾ã™ã€‚

```
Path                                                  Name
----                                                  ----
/wfsvc/a1ef7b8ae5554ee18af83707d4bdef88
/wfsvc/a1ef7b8ae5554ee18af83707d4bdef88/workflow.xaml Test Workflow 1
```

`workflow.xaml` ãŒãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æœ¬ä½“ã§ã™ã€‚ã‚ˆã£ã¦ã“ã‚Œã‚’ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã”ã¨å‰Šé™¤ã—ã¦ã—ã¾ã„ã¾ã™ã€‚

```
$folder = $web.GetFolderByServerRelativeUrl('/wfsvc/a1ef7b8ae5554ee18af83707d4bdef88')
$folder.DeleteObject()
$context.ExecuteQuery()
```

å‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼

![](/images/2019_09_02_190000_002.png)
