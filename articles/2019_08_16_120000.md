---
title: "SharePoint Online のコミュニケーション サイトではリスト テンプレートやソリューションをアップロードできない"
emoji: "💻"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2019/8/16 に投稿したものの転載です。
:::

SharePoint Online のコミュニケーション サイトでは、**サイトの設定** - **Web デザイナー ギャラリー** でリスト テンプレートやソリューションのギャラリーへのリンクが表示されず、また直リンクでギャラリーにアクセスしてファイルをアップロードしようとしてもアクセスが拒否されます。この動作は、たとえユーザーがサイト コレクション管理者であっても同様です。

それはそうなのですが、では内部ではどのような仕組みになっているかというと、コミュニケーション サイトのテンプレートでサイト コレクションを作成したときに、`SPSite.DenyPermissionsMask` プロパティに `AddAndCustomizePages` が設定されます。この動作は SharePoint 2019 で確認することができます。SharePoint 2019 であれば、`SPSite.DenyPermissionsMask` プロパティを更新するか、ファーム アカウントでアクセスすると使えるようになるのですが、残念ながら SharePoint Online では、どちらの方法も使えないため、回避策はないようです。

ちなみに、Office 365 グループに接続されたチーム サイトでも同様ですが、Office 365 グループなしのチーム サイトであれば、リスト テンプレートやソリューションは使えるようです。あまり使う機会はないかもしれませんが、覚えておくと何かのときに役に立つかもしれません。
