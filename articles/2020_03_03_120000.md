---
title: "SharePoint Framework ã§ Angular ã‚’ä½¿ç”¨ã™ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["sharepoint"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2020/3/3 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

# ã¯ã˜ã‚ã«

SharePoint Framework ã®å…¬å¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã‚ã‚‹ `@microsoft/generator-sharepoint` ã§ã¯ã€ä½¿ç”¨ã§ãã‚‹ JavaScript ã® Framework ã« React ã¾ãŸã¯ Knockout (ã¾ãŸã¯ JavaScript Framework ã‚’ä½¿ç”¨ã—ãªã„) ã¨ã„ã†é¸æŠè‚¢ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€SharePoint ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã‚ã‚‹ PnP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ `@pnp/generator-spfx` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Angular ã‚’ä½¿ã£ã¦ SharePoint Framework ã®ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

# å®Ÿè¡Œæ–¹æ³•

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

é€šå¸¸ã® SharePoint Framework ã¨åŒæ§˜ã« Gulp ãŠã‚ˆã³ Yo ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
npm install -g yo gulp
```

Angular CLI ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚`@pnp/generator-spfx` ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹ Angular ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ç¾æ™‚ç‚¹ã§ã¯ 6 ã‹ã‚‰ 8 ã®ã‚ˆã†ãªã®ã§ã€æœ€æ–°ã® 8.3.25 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
npm install -g @angular/cli@8.3.25
```

`@pnp/generator-spfx` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚åˆ¥é€” `@microsoft/generator-sharepoint` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```
npm inatall -g @pnp/generator-spfx
```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

Yo ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```
yo @pnp/spfx
```

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ãªã‚‹ SharePoint ã®ç¨®é¡ã‚’èã‹ã‚Œã‚‹ã®ã§ **SharePoint Online only (latest)** ã‚’é¸æŠã—ã¾ã™ã€‚

```
? Which baseline packages do you want to target for your component(s)? (Use arrow keys)
> SharePoint Online only (latest)
  SharePoint 2019 onwards, including SharePoint Online
  SharePoint 2016 onwards, including 2019 and SharePoint Online
```

ä½¿ç”¨ã™ã‚‹ JavaScript Framework ã‚’èã‹ã‚Œã¾ã™ã€‚ã“ã“ã§ã€Angular CLI ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã« Angular CLI ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ãŒã€ã†ã¾ãã„ã‹ãªã„ã¨ãã¯ã€å¼·å¼•ã§ã™ãŒã€`%USERPROFILE%\AppData\Roaming` ã® `npm` ã¨ `npm-cache` ã‚’å‰Šé™¤ã—ã¦ã€æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```
? Choose your framework (Use arrow keys)
  Additional Frameworks
> - Handlebars
  - Vue.js
  - Angular Elements (uses @angular/cli 8.3.25)
  Enhanced SPFx
  - ReactJS
  - Knockout (deprecated)
```

è¿½åŠ ã§ä½¿ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æŒ‡å®šã—ã¾ã™ã€‚

```
? Which libraries to include ? (Press <space> to select, <a> to toggle all, <i> to invert selection)
>( ) jQuery
 ( ) Microsoft Graph - Type Definitions
 ( ) pnpjs
 ( ) PnP Property Controls
 ( ) spfx-uifabric-themes - enhanced theming support
 ( ) lodash   
```

TypeScript ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```
? TypeScript:  Please choose a version: (Use arrow keys)
> TypeScript v3.3 - Default
  TypeScript v3.4
  TypeScript v3.5
  TypeScript v3.6
  TypeScript v3.7
```

æ¤œæŸ»ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```
? Vetting Options (Press <space> to select, <a> to toggle all, <i> to invert selection)
>( ) WebPack Bundle Analyzer
 ( ) Style Linter
 ( ) CSS Comb   
```

Azure DevOps ã® Azure Pipeline ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã® YAML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```
? Include pipeline configuration? (Use arrow keys)
> None
  Azure DevOps
  Azure DevOps Multi-Stage Pipeline with deployment (preview)                                                                                                                           
```

Angular ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’æŒ‡å®šã—ã¾ã™ã€‚

```
? What is your solution name? (HelloWorld)
```

Angular CLI ã§ `ng new` ã‚’ã™ã‚‹ã¨ãã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚å€‹äººçš„ã«ã¯ `enable-ivy` ã¯ç„¡åŠ¹åŒ–ã—ãŸã»ã†ãŒå®‰å®šã™ã‚‹æ°—ãŒã—ã¾ã—ãŸã€‚

```
Angular CLI options: (--style=scss --routing=false --skip-git --enable-ivy)
```

ã“ã“ã¾ã§ã„ãã¨ã€ä»¥ä¸‹ã¯ SharePoint Framework ã®è¨­å®šã«ãªã‚Šã¾ã™ã€‚SharePoint Framework ã®è¨­å®šã«ã¤ã„ã¦ã¯çœç•¥ã—ã¾ã™ãŒã€ã™ã¹ã¦ã®è¨­å®šãŒçµ‚ã‚ã‚‹ã¨ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆãŒè¡Œã‚ã‚Œã¾ã™ã€‚ä½œæˆå¾Œã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’è¦‹ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã« Angular ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ SharePoint Framework ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® 2 ã¤ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

```
2020/03/03  11:03               406 .yo-rc.json
2020/03/03  11:05    <DIR>          HelloWorld
2020/03/03  11:07    <DIR>          HelloWorld-spfx
```

ã§ã¯ 2 ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã©ã®ã‚ˆã†ã«é–¢ä¿‚ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†ã¨ã€SharePoint Framework ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `package.json` ã§ Angular ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ã¨ã„ã†ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```json
  "dependencies": {
    "@microsoft/sp-core-library": "1.10.0",
    "@microsoft/sp-lodash-subset": "1.10.0",
    "@microsoft/sp-office-ui-fabric-core": "1.10.0",
    "@microsoft/sp-property-pane": "1.10.0",
    "@microsoft/sp-webpart-base": "1.10.0",
    "@types/es6-promise": "0.0.33",
    "@types/webpack-env": "1.13.1",
    "hello-world": "file:../HelloWorld"
  }
```

# ãŠã‚ã‚Šã«

SharePoint Framework å…¬å¼ã® React ã§ä½œã£ãŸã¨ãã¯ã€1 ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½œæˆã•ã‚Œã‚‹ã®ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹æˆã®é•ã„ã«æˆ¸æƒ‘ã†ã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ç‰¹ã«ã€React ã®ã‚ˆã†ã«ã€context ãªã©ã® SharePoint Framework ã®æƒ…å ±ã‚’æ¸¡ã™ã“ã¨ã¯ã§ããªã„ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
