---
title: "CSOM ã® Site.OpenWeb ãƒ¡ã‚½ãƒƒãƒ‰ã§ File Not Found ãŒç™ºç”Ÿã™ã‚‹ä»¶ã«ã¤ã„ã¦"
emoji: "ğŸ’»"
type: "tech"
topics: ["powershell", "sharepoint"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2017/4/21 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

:::message alert
2019/4/24 è¿½è¨˜: SharePoint 2016 ä»¥é™ã® CSOM ã§ã¯ `DisableReturnValueCache` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã®ã§ã“ã‚Œã‚’ä½¿ã†ã“ã¨ã«ã‚ˆã£ã¦å›é¿ã§ãã¾ã™ã€‚
:::

CSOM ã§ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«åŒã˜ã‚µã‚¤ãƒˆã‚’ä½œæˆã—ãŸã‚Šå‰Šé™¤ã—ãŸã‚Šã‚’ç¹°ã‚Šè¿”ã™ã¨ `ServerException (File Not Found)` ãŒç™ºç”Ÿã—ã¾ã™ã€‚
æœ€åˆã¯ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®å•é¡Œã‹ãªã¨æ€ã£ãŸã®ã§ã™ãŒã€ã‚¹ãƒªãƒ¼ãƒ—ã‚’å…¥ã‚Œã¦ã‚‚å¸¸ã«ç™ºç”Ÿã™ã‚‹ã®ã§ã€ãã†ã„ã†å•é¡Œã§ã‚‚ãªã•ãã†ã€‚

```powershell
$context.Load($context.Site)
$context.ExecuteQuery()

for ($i = 0; $i -lt 2; $i++) {
    # ã‚µã‚¤ãƒˆã‚’ä½œæˆã™ã‚‹
    $web = New-Object Microsoft.SharePoint.Client.WebCreationInformation
    $web.Url = "{{site-name}}"
    $context.Web.Webs.Add($web) | Out-Null
    $context.ExecuteQuery()

    # ã‚µã‚¤ãƒˆã‚’å–å¾—ã™ã‚‹
    $web = $context.Site.OpenWeb($context.Site.ServerRelativeUrl + "/{{site-name}}")
    $context.Load($web)
    $context.ExecuteQuery()

    # ã‚µã‚¤ãƒˆã‚’å‰Šé™¤ã™ã‚‹
    $web.DeleteObject()
    $context.ExecuteQuery()
}
```

ãã“ã§ OpenWeb ã®å®Ÿè£…ã‚’ ILSpy ã§è¦‹ã¦ã¿ãŸã¨ã“ã‚ã€‚

![](/images/2017_04_21_150000_001.png)

(ã€€ï¾ŸĞ´ï¾Ÿ)

(ã¤Ğ´âŠ‚)ï½ºï¾ï½¼ï½ºï¾ï½¼

(ï¼›ï¾ŸĞ´ï¾Ÿ)
