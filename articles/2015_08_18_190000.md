---
title: "SharePoint 2013 のリストに内部名でアクセスする"
emoji: "💻"
type: "tech"
topics: ["powershell", "sharepoint"]
published: true
---

:::message
この記事ははてなブログに 2015/8/18 に投稿したものの転載です。
:::

:::message alert
2016/2/17 追記: リスト名を取得する方法を修正しました。
:::

SharePoint 2013 のリストには内部名と表示名が存在します。`SPListItemCollection` オブジェクトのインデクサからリストを取得するときは、表示名を指定しなければなりません。

```powershell
$web = Get-SPWeb http://sharepoint.example.com
$list = $web.Lists["サイトのページ"]  # 取得できる
$list = $web.Lists["SitePages"]  # 取得できない
```

表示名は変更可能ですので、メンテナンスを考えると、表示名を指定するのは望ましくありません。そこで、内部名を指定して取得するために、`SPList.GetList` メソッドが使用できます。ちなみにカスタム リストのような場合は URL が `/Lists/List1` のようになりますので、注意が必要です。

```powershell
$web = Get-SPWeb http://sharepoint.example.com
$list = $web.GetList($web.ServerRelativeUrl.TrimEnd("/") + "/SitePages")  # 取得できる
```

なお、列の場合は、内部名でも表示名でも取得できるようです。

```powershell
$item = $list.Items[0]
$value = $item["Modified"] # 取得できる
$value = $item["更新日時"]  # 取得できる
```
