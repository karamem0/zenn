---
title: "WSL2 ã® Ubuntu ã‹ã‚‰ SqlConnection ã‚’ä½¿ã£ã¦ Azure SQL Database ã«æ¥ç¶šã§ããªã„"
emoji: "ğŸ’»"
type: "tech"
topics: ["azure", "csharp"]
published: true
---

ãƒãƒã£ãŸã®ã§ãƒ¡ãƒ¢ã€‚

WSL2 ä¸Šã«æ§‹ç¯‰ã—ãŸ Ubuntu ã§ Azure SQL Database ã«æ¥ç¶šã™ã‚‹ C# ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ãŸã¨ã“ã‚ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

>> System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 40 - Could not open a connection to SQL Server)

Azure SQL Database ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¯æ§‹æˆæ¸ˆã¿ã§ã™ã€‚ã¾ãŸãƒ›ã‚¹ãƒˆã® Windows ã‚„ Ubuntu ã‹ã‚‰ sqlcmd ã‚’ã—ãŸå ´åˆã¯æ¥ç¶šã§ãã¾ã™ã€‚C# ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã ã‘ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¨ã„ã†çŠ¶æ…‹ã§ã™ã€‚`apt-get upgrade` ã‚„ `wsl --update` ã‚’å®Ÿæ–½ã—ã¦ã‚‚åŠ¹æœã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚æ¤œç´¢ã™ã‚‹ã¨ openssl ã®è¨­å®šãŒã¨ã„ã†æƒ…å ±ã‚‚è¦‹ã‹ã‘ã¾ã—ãŸãŒãã¡ã‚‰ã‚’å®Ÿæ–½ã—ã¦ã‚‚è§£æ±ºã—ã¾ã›ã‚“ã§ã—ãŸã€‚

çµæœçš„ã«ã¯ `/etc/resolv.conf` ã‚’ä¿®æ­£ã™ã‚‹ã“ã¨ã§è§£æ±ºã—ã¾ã—ãŸã€‚

```diff
- nameserver 172.28.32.1
+ nameserver 8.8.8.8
```

ã¤ã„ã§ã«å…ƒã«æˆ»ã‚‰ãªã„ã‚ˆã†ã« `/etc/wsl.conf` ã‚‚ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```
[network]
generateResolvConf = false
```
