---
title: "Microsoft Graph ã§ã‚‚ SharePoint ãƒªã‚¹ãƒˆ ã‚¢ã‚¤ãƒ†ãƒ ã®è¤‡æ•°ã®å€¤ã‚’æŒã¤åˆ—ãŒæ›´æ–°ã§ããªã„"
emoji: "ğŸ’»"
type: "tech"
topics: ["microsoftgraph", "sharepoint"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2018/10/11 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

SharePoint REST API ã®æ™‚ä»£ã‹ã‚‰ã§ã™ãŒè¤‡æ•°ã®å€¤ã‚’æŒã¤åˆ— (`MultiChoice`ã€`UserMulti`ã€`LookupMulti`) ã‚’æ›´æ–°ã§ããªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚è‹±èªãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã®æƒ…å ±ã‚’è¦‹ã¦ã‚‚ã§ãã‚‹ã¨ã„ã†æƒ…å ±ã‚‚ã‚ã£ãŸã‚Šã§ããªã„ã¨ã„ã†æƒ…å ±ãŒã‚ã£ãŸã‚Šã—ã¦éŒ¯ç¶œã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€å°‘ãªãã¨ã‚‚ç§ãŒè©¦ã—ãŸé™ã‚Šã§ã¯è§£æ±ºã§ãã¦ã„ã¾ã›ã‚“ã€‚

å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã‚‹ã¨

```
POST https://example.sharepoint.com/_api/web/lists('{{list-id}}')/items({{item-id}})
Authorization: Bearer {{access-token}}
Accept: application/json; odata=verbose
Content-Type: application/json; odata=verbose

{
    "__metadata": {
        "type": "SP.ListItem"
    },
    "ChoiceField": {
        "results": [
            "Test Value"
        ]
    }
}
```

400 ã‚¨ãƒ©ãƒ¼ãŒè¿”ã£ã¦ãã¾ã™ã€‚[^1]

> Microsoft.SharePoint.Client.InvalidClientQueryException: A value without a type name was found and no expected type is available. When the model is specified, each value in the payload must have a type which can be either specified in the payload, explicitly by the caller or implicitly inferred from the parent value. [^2]

ã“ã‚Œ Microsoft Graph ã§æ”¹å–„ã—ã¦ã‚‹ã®ã‹ãªã¨æ€ã£ã¦ãµã¨è©¦ã—ãŸã¨ã“ã‚å…¨ç„¶æ²»ã£ã¦ã„ãªã„ã¿ãŸã„ã§ã™ã€‚

```json
{
    "error": {
        "code": "-1, Microsoft.SharePoint.Client.InvalidClientQueryException",
        "message": "A value without a type name was found and no expected type is available. When the model is specified, each value in the payload must have a type which can be either specified in the payload, explicitly by the caller or implicitly inferred from the parent value.",
    }
}
```

ã¾ã‚ Microsoft Graph ã¯ SharePoint REST API ã‚’ãƒ©ãƒƒãƒ—ã—ã¦ã„ã‚‹ã ã‘ãªã®ã§å½“ãŸã‚Šå‰ã¨ã„ãˆã°å½“ãŸã‚Šå‰ãªã®ã§ã™ãŒã€æ‚²ã—ã„æ°—æŒã¡ã«ãªã‚Šã¾ã—ãŸã¨ã„ã†ãŠè©±ã€‚

[^1]: ã¡ãªã¿ã«ä¾‹å¤–ã¨ã—ã¦ `null` ã‚’å…¥ã‚Œã‚‹ã¨ 200 ãŒè¿”ã£ã¦ãã¾ã™ã€‚ã¤ã‚‰ã„ã€‚

[^2]: å‹åã®ãªã„å€¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸãŒã€ä½¿ç”¨ã§ãã‚‹å¿…è¦ãªå‹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ¢ãƒ‡ãƒ«ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰å†…ã®å€¤ã”ã¨ã«ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§æŒ‡å®šã§ãã‚‹å‹ãŒå¿…è¦ã§ã™ã€‚ãã®å‹ã¯ã€å‘¼ã³å‡ºã—å…ƒã«ã‚ˆã‚‹æ˜ç¤ºçš„ãªå‹ã‹ã€è¦ªå€¤ã‹ã‚‰æš—é»™çš„ã«æ¨å®šã•ã‚Œã‚‹å‹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
