---
title: "Microsoft Teams Toolkit ã§ TypeScript ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹"
emoji: "ğŸ’»"
type: "tech"
topics: ["microsoftteams", "typescript"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« 2021/2/16 ã«æŠ•ç¨¿ã—ãŸã‚‚ã®ã®è»¢è¼‰ã§ã™ã€‚
:::

# ã¯ã˜ã‚ã«

å‰å›ã®è¨˜äº‹ã§ã¯ Microsoft Teams Toolkit ã‚’ä½¿ã£ã¦ã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã¾ã§ã®æ‰‹é †ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚

https://zenn.dev/karamem0/articles/2021_02_12_090000

è¨˜äº‹ä¸­ã«ã‚‚èª¬æ˜ã—ãŸé€šã‚Šã€Microsoft Teams Toolkit ã®æ—¢å®šã®è¨€èªã¯ JavaScript ã§ã™ã€‚ã—ã‹ã—ã€ãƒ¢ãƒ€ãƒ³é–‹ç™ºã‚’è¡Œã†ä¸Šã§ TypeScript ã‚’ä½¿ã†ã“ã¨ã¯å¿…é ˆã¨ã‚‚è¨€ãˆã¾ã™ã€‚ãã“ã§ã€Microsoft Teams Toolkit ã§ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ TypeScript ã‚’æ‰±ã†ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# å®Ÿè¡Œæ–¹æ³•

## æ‹¡å¼µå­ã®å¤‰æ›´

JavaScript ã®æ‹¡å¼µå­ã§ã‚ã‚‹ `js` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ TypeScript ã®ã‚‚ã®ã«å¤‰æ›´ã—ã¾ã™ã€‚é€šå¸¸ã® TypeScript ã®æ‹¡å¼µå­ã¯ `ts` ã§ã™ãŒã€React ã® JSX ã‚’æ‰±ã†å ´åˆã¯æ‹¡å¼µå­ã¯ `tsx` ã¨ãªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’å¤‰æ›´ã—ã¾ã™ã€‚

- `src`
  - `index.js` -> `index.tsx`
  - `components`
    - `App.js` -> `App.tsx`
    - `Privacy.js` -> `Privacy.tsx`
    - `Tab.js` -> `Tab.tsx`
    - `TermsOfUse.js` -> `TermsOfUse.tsx`

## å‹å®šç¾©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

React ã®æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‹è§£æ±ºã§ãã‚‹ã‚ˆã†ã«å‹å®šç¾©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

- `@types/react`
- `@types/react-dom`
- `@types/react-router-dom`

```
npm install @types/react @types/react-dom @types/react-router-dom --save-dev
```

## TypeScript ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

TypeScript ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

- `typescript`

```
npm install typescript
```

TypeScript ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã«ã¯ `tsconfig.json` ãŒå¿…è¦ãªã®ã§ã™ãŒã€åˆå›ã« `npm run start` ã—ãŸã¨ãã«è‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ã®ã§ã€ã„ã£ãŸã‚“ã¯ãã®ã¾ã¾ã§å•é¡Œãªã„ã§ã™ã€‚

## Tab.tsx ã®ä¿®æ­£

`Tab.tsx` ãŒå‹è§£æ±ºã§ããšã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ä¿®æ­£ã—ã¾ã™ã€‚

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¿½åŠ 

React ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¯ [Props](https://ja.reactjs.org/docs/components-and-props.html) ã¨ [State](https://ja.reactjs.org/docs/state-and-lifecycle.html) ãŒã‚ã‚Šã¾ã™ãŒã“ã‚Œã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§å®šç¾©ã—ã¾ã™ã€‚

```typescript
interface ITabProps { }
interface ITabState {
  context: microsoftTeams.Context
}
```

### ã‚¯ãƒ©ã‚¹å®šç¾©ã®ä¿®æ­£

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç¶™æ‰¿ã‚’ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã«ãªã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```typescript
class Tab extends React.Component<ITabProps, ITabState> {
  ...
}
```

### ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ä¿®æ­£

ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯å‹ã‚’æŒ‡å®šã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```typescript
constructor(props: ITabProps) {
  super(props)
  this.state = {
    context: {} as microsoftTeams.Context
  }
}
```

### componentDidMount ã®ä¿®æ­£

`microsoftTeams.getContext` ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®šç¾©ã¨åˆã‚ãšã«ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã‚‹ã®ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã® `error` ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

```typescript
componentDidMount() {
  microsoftTeams.getContext((context) => {
    this.setState({
      context: context
    });
  });
}
```

ã“ã‚Œã§ `npm run start` ã™ã‚Œã°ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒæˆåŠŸã™ã‚‹ã¯ãšã§ã™ã€‚

# ãŠã‚ã‚Šã«

ã¡ãªã¿ã«ã€ãã‚‚ãã‚‚ React ã§ã¯ã‚¯ãƒ©ã‚¹ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ãªãé–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã†ã‚ˆã†ã«ãªã£ã¦ãã¦ã„ã¾ã™ã®ã§ã€ã¾ã‚‹ã£ã¨æ›¸ãç›´ã—ã¦ã—ã¾ã£ãŸã»ã†ãŒé€Ÿã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã•ã£ãã‚Šã¨æ›¸ãç›´ã—ãŸå ´åˆã€ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚

```typescript
import React from 'react';
import './App.css';
import * as microsoftTeams from "@microsoft/teams-js";

const Tab: React.FC = () => {

  const [context, setContext] = React.useState<microsoftTeams.Context>();
  const [userName, setUserName] = React.useState<string>();

  React.useEffect(() => {
    microsoftTeams.getContext((value) => {
      setContext(value);
    });
  }, []);

  React.useEffect(() => {
    if (context) {
      setUserName(Object.keys(context).length > 0 ? context['upn'] : "");
    }
  }, [context]);

  return (
    <div>
      <h3>Hello World!</h3>
      <h1>Congratulations {userName}!</h1> <h3>This is the tab you made :-)</h3>
    </div>
  );

}

export default Tab;
```
